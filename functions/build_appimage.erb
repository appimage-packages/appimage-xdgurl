#!/bin/bash
cd /
mkdir /<%= name %>.AppDir/
mv /app/usr /<%= name %>.AppDir/usr
cp  -v  /<%= name %>.AppDir/usr/share/applications/<%= name %>.desktop /<%= name %>.AppDir
cp  -v /<%= name %>.AppDir/usr/share/icons/hicolor/scalable/apps/<%= name %>.svg /<%= name %>.AppDir
wget https://github.com/probonopd/linuxdeployqt/releases/download/1/linuxdeployqt-1-x86_64.AppImage
chmod a+x linuxdeployqt-1-x86_64.AppImage

DESTIDIR=/<%= name %>.AppDir ./linuxdeployqt-1-x86_64.AppImage /<%= name %>.AppDir/usr/bin/<%= name %>

# Until this repo stabilizes we will use the appimage.
# Build AppImageKit

wget "https://github.com/probonopd/AppImageKit/releases/download/continuous/appimagetool-x86_64.AppImage"
chmod a+x appimagetool-x86_64.AppImage

VERSION=<%= version %>
ARCH=$(arch)
APP=<%= name %>

./appimagetool-x86_64.AppImage /xdgurl.AppDir /appimage/$APP_$VERSION_$ARCH.AppImage
